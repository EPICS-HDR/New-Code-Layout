import requests
import pandas as pd

station_ids = ["SWLAZZZ2411A","SWLAZZZ2411B","SWLAZZZ2411C","SWLAZZZ2411","SWLAZZZ2402B","SWLAZZZ2402","SWLAZZZ2402A",
               "SWLAZZZ2402C","460945","460935","CAMPPOCP01","CITMONZ2417AA","FFLOaheMoreauRE","FFLittleMoreauL#1",
               "FFLOaheGrandRE","FW08RSDP04R052","SWLAZZZ2013","SWLAZZZ2013A","SWLAZZZ2013B","SWLAZZZ2013C","SWLAZZZ2412A",
               "SWLAZZZ2412B","SWLAZZZ2412C","SWLAZZZ2412","SWLAZZZ6302A","SWLAZZZ6302B","SWLAZZZ6302C","SWLAZZZ6302",
               "SD_10096","SD_10100","SD_10697","SD_11901","SD_11903","SD_11904","SWLABAC2411","SWLAZZZ4913A",
               "SWLAZZZ2410","SWLAZZZ2410A","SWLAZZZ2410B","SWLAZZZ2410C","SWLAZZZ4911A","SWLAZZZ4911B","SWLAZZZ4911C",
               "SWLAZZZ4911","SWLAZZZ2408","SWLAZZZ2408A","SWLAZZZ2408B","SWLAZZZ2408C","GFPZZZ3502","SWLAZZZ5303",
               "SWLAZZZ5303A","SWLAZZZ5303B","SWLAZZZ5303C","SWLAZZZ5305","SWLAZZZ5305A","SWLAZZZ5305B","SWLAZZZ5305C",
               "GFPZZZ5315","SWLAZZZ5315","SWLAZZZ5315A","SWLAZZZ5315B","SWLAZZZ5315C","GFPZZZ5316","GRANDRZCROOKED",
               "GRANDRZBULL","GRANDRZJONES","GRANDRZHORSE","GRANDRZBIGNASTY","GRANDRZLODGEPOL","GRANDRZBUTCHER",
               "GRANDRZCLARKSFK","GRANDRZSRO05","GRANDRZNFG02","GRANDRZSFG08","GRANDRZSFG07","GRANDRZNFG03",
               "GRANDRZNFG01","GRANDRZSFG06","GRANDRZSFG04","SWLAZZZ3502A","SWLAZZZ3502B","SWLAZZZ3502C","SWLAZZZ3502",
               "460955","460144","460143","460139","460678","460039","460640","460147","460138","460677","460160","460161","460162","SWLAZZZ5313A","SWLAZZZ5313C","SWLAZZZ5313B","SWLAZZZ5313","SWLAZZZ2409A","SWLAZZZ2409B","SWLAZZZ2409C","SWLAZZZ2409","SHDHILL1A","SHDHILL1B","SHDHILL1C","FFCoalSp","FFLIsabel","FFLittleMissouriR","FFShadehillR","FFPudwellD","LIMIRV01","LIMIRV02","FW08SD056","SWLAZZZ5301","SWLAZZZ5301A","SWLAZZZ5301B","SWLAZZZ5301C","460193","SWLAZZZ5319A","SWLAZZZ5319B","SWLAZZZ5319C","SWLAZZZ5319","SWLAZZZ2006A","SWLAZZZ2006B","SWLAZZZ2006C","SWLAZZZ2006","SD_10014","SD_10027","SD_10037","SD_10039","SD_11295","SD_11299","SD_11896","SD_11905","FFFlatCreekL","SWLABAC5315","SWLABAC3502","FFGardnerL","SWLABAC2408","SWLABAC5303","SWLABAC5309","SWLAZZZ5309","SWLAZZZ5309B","SWLAZZZ5309A","SWLAZZZ5309C","SWLABAC5305","SWLABAC2010","SWLAZZZ2010","SWLAZZZ2010B","SWLAZZZ2010A","SWLAZZZ2010C",]
mainjson = {}
for i in station_ids:
    try:
        print(i)
        r = requests.get(f"https://apps.sd.gov/NR92WQMAP/api/Station/{i}")
        # mainjson += r
        mainjson[i] = r.json()
    except:
        print("Error pulling", {i})
pd.DataFrame(mainjson).to_csv("DANR.csv")



